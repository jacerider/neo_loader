{"version":3,"file":"loader.ajax.js","sources":["../../src/js/loader.ajax.js"],"sourcesContent":["(function ($, window, Drupal, drupalSettings) {\n\n  'use strict';\n\n  /**\n   * Prepare the Ajax request before it is sent.\n   *\n   * @param {XMLHttpRequest} xmlhttprequest The xml httpprequest.\n   * @param {object} options The options.\n   * @param {object} options.extraData The option extra data.\n   */\n  Drupal.Ajax.prototype.beforeSendOriginal = Drupal.Ajax.prototype.beforeSend;\n  Drupal.Ajax.prototype.beforeSend = function (xmlhttprequest, options) {\n    if (this.$form) {\n      $('body').addClass('ajax-loading');\n    }\n    this.beforeSendOriginal(xmlhttprequest, options);\n  };\n\n  /**\n   * Overrides the throbber progress indicator.\n   */\n  Drupal.Ajax.prototype.progressTimer = 0;\n  Drupal.Ajax.prototype.setProgressIndicatorThrobberOriginal = Drupal.Ajax.prototype.setProgressIndicatorThrobber;\n  Drupal.Ajax.prototype.setProgressIndicatorThrobber = function () {\n    if (drupalSettings.neoLoader.alwaysFullscreen) {\n      this.setProgressIndicatorFullscreen();\n      return;\n    }\n\n    const message = this.progress.message && !drupalSettings.neoLoader.hideAjaxMessage ? this.progress.message : null;\n    const element = Drupal.behaviors.neoLoader.show(message, 'throbber', this.element, 300);\n    if (element) {\n      $('body').addClass('ajax-loading');\n      this.progress.element = $(element);\n    }\n    else {\n      Drupal.Ajax.prototype.setProgressIndicatorThrobberOriginal.call(this);\n    }\n  };\n\n  /**\n   * Sets the fullscreen progress indicator.\n   */\n  Drupal.Ajax.prototype.setProgressIndicatorFullscreenOriginal = Drupal.Ajax.prototype.setProgressIndicatorFullscreen;\n  Drupal.Ajax.prototype.setProgressIndicatorFullscreen = function () {\n    const message = this.progress.message && !drupalSettings.neoLoader.hideAjaxMessage ? this.progress.message : null;\n    const element = Drupal.behaviors.neoLoader.show(message, 'fullscreen', 'body', 300);\n    if (element) {\n      $('body').addClass('ajax-loading');\n      this.progress.element = $(element);\n    }\n    else {\n      Drupal.Ajax.prototype.setProgressIndicatorFullscreenOriginal.call(this);\n    }\n  };\n\n  /**\n   * Transition out.\n   */\n  Drupal.Ajax.prototype.successOriginal = Drupal.Ajax.prototype.success;\n  Drupal.Ajax.prototype.success = function (response, status) {\n    var _this = this;\n    const callback = function () {\n      _this.progress.element = null;\n      var closest = $(_this.progress.element).closest('.ajax-progress-wrapper');\n      if (closest.length) {\n        closest.removeClass('ajax-progress-wrapper');\n      }\n      $('body').removeClass('ajax-loading');\n      Drupal.Ajax.prototype.successOriginal.call(_this, response, status);\n    }\n    const element = Drupal.behaviors.neoLoader.hide(callback);\n    if (!element) {\n      Drupal.Ajax.prototype.successOriginal.call(this, response, status);\n    }\n  };\n\n})(jQuery, this, Drupal, drupalSettings);\n"],"names":["$","window","Drupal","drupalSettings","xmlhttprequest","options","message","element","response","status","_this","callback","closest","this"],"mappings":"CAAC,SAAUA,GAAGC,GAAQC,GAAQC,GAAgB;AAW5C,EAAAD,EAAO,KAAK,UAAU,qBAAqBA,EAAO,KAAK,UAAU,YACjEA,EAAO,KAAK,UAAU,aAAa,SAAUE,GAAgBC,GAAS;AACpE,IAAI,KAAK,SACPL,EAAE,MAAM,EAAE,SAAS,cAAc,GAEnC,KAAK,mBAAmBI,GAAgBC,CAAO;AAAA,EAChD,GAKDH,EAAO,KAAK,UAAU,gBAAgB,GACtCA,EAAO,KAAK,UAAU,uCAAuCA,EAAO,KAAK,UAAU,8BACnFA,EAAO,KAAK,UAAU,+BAA+B,WAAY;AAC/D,QAAIC,EAAe,UAAU,kBAAkB;AAC7C,WAAK,+BAAgC;AACrC;AAAA,IACN;AAEI,UAAMG,IAAU,KAAK,SAAS,WAAW,CAACH,EAAe,UAAU,kBAAkB,KAAK,SAAS,UAAU,MACvGI,IAAUL,EAAO,UAAU,UAAU,KAAKI,GAAS,YAAY,KAAK,SAAS,GAAG;AACtF,IAAIC,KACFP,EAAE,MAAM,EAAE,SAAS,cAAc,GACjC,KAAK,SAAS,UAAUA,EAAEO,CAAO,KAGjCL,EAAO,KAAK,UAAU,qCAAqC,KAAK,IAAI;AAAA,EAEvE,GAKDA,EAAO,KAAK,UAAU,yCAAyCA,EAAO,KAAK,UAAU,gCACrFA,EAAO,KAAK,UAAU,iCAAiC,WAAY;AACjE,UAAMI,IAAU,KAAK,SAAS,WAAW,CAACH,EAAe,UAAU,kBAAkB,KAAK,SAAS,UAAU,MACvGI,IAAUL,EAAO,UAAU,UAAU,KAAKI,GAAS,cAAc,QAAQ,GAAG;AAClF,IAAIC,KACFP,EAAE,MAAM,EAAE,SAAS,cAAc,GACjC,KAAK,SAAS,UAAUA,EAAEO,CAAO,KAGjCL,EAAO,KAAK,UAAU,uCAAuC,KAAK,IAAI;AAAA,EAEzE,GAKDA,EAAO,KAAK,UAAU,kBAAkBA,EAAO,KAAK,UAAU,SAC9DA,EAAO,KAAK,UAAU,UAAU,SAAUM,GAAUC,GAAQ;AAC1D,QAAIC,IAAQ;AACZ,UAAMC,IAAW,WAAY;AAC3B,MAAAD,EAAM,SAAS,UAAU;AACzB,UAAIE,IAAUZ,EAAEU,EAAM,SAAS,OAAO,EAAE,QAAQ,wBAAwB;AACxE,MAAIE,EAAQ,UACVA,EAAQ,YAAY,uBAAuB,GAE7CZ,EAAE,MAAM,EAAE,YAAY,cAAc,GACpCE,EAAO,KAAK,UAAU,gBAAgB,KAAKQ,GAAOF,GAAUC,CAAM;AAAA,IACxE;AAEI,IADgBP,EAAO,UAAU,UAAU,KAAKS,CAAQ,KAEtDT,EAAO,KAAK,UAAU,gBAAgB,KAAK,MAAMM,GAAUC,CAAM;AAAA,EAEpE;AAEH,GAAG,QAAQI,QAAM,QAAQ,cAAc;"}